# TP-002 : Détection de sentiment

## Objectif
L'objectif de ce travail pratique est de comprendre les bases des réseaux neuronaux en utilisant TensorFlow ou PyTorch pour effectuer une tâche de détection de sentiment.

## Contexte
La détection de sentiment est une tâche courante en traitement du langage naturel (NLP) où le but est d'identifier si un texte exprime une opinion positive, négative ou neutre.

## Prérequis
- Avoir une connaissance de base en Python.
- Avoir installé TensorFlow ou PyTorch.

## Étapes du TP

### 1. Importer les bibliothèques nécessaires
Pour commencer, nous devons importer les bibliothèques nécessaires à notre tâche.

```python
import pandas as pd
import numpy as np
import tensorflow as tf  # ou import torch pour PyTorch
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
from tensorflow.keras.preprocessing.text import Tokenizer
from tensorflow.keras.preprocessing.sequence import pad_sequences
```

### 2. Charger les données
Nous allons utiliser un ensemble de données de critiques de films pour notre modèle. Téléchargez un fichier CSV contenant des critiques de films.

```python
# Charger les données
data = pd.read_csv('chemin/vers/votre_fichier.csv')
print(data.head())
```

### 3. Prétraitement des données
Il est important de transformer les textes et les étiquettes en un format que notre modèle peut comprendre.

```python
# Étiquettes
labels = data['sentiment']
label_encoder = LabelEncoder()
labels = label_encoder.fit_transform(labels)
# Textes
texts = data['review']

# Tokenisation
tokenizer = Tokenizer(num_words=5000)
tokenizer.fit_on_texts(texts)
sequences = tokenizer.texts_to_sequences(texts)
word_index = tokenizer.word_index

# Padding des séquences
max_length = 100
X = pad_sequences(sequences, maxlen=max_length)
Y = np.array(labels)
```

### 4. Diviser les données
Séparons notre jeu de données en jeux d'entraînement et de test.

```python
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=42)
```

### 5. Créer le modèle
Nous allons créer un modèle simple à l'aide de TensorFlow.

```python
model = tf.keras.Sequential([
    tf.keras.layers.Embedding(input_dim=len(word_index) + 1, output_dim=64),
    tf.keras.layers.GlobalAveragePooling1D(),
    tf.keras.layers.Dense(64, activation='relu'),
    tf.keras.layers.Dense(3, activation='softmax')  # 3 classes : positif, négatif, neutre
])

model.compile(loss='sparse_categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
```

### 6. Entraîner le modèle
Entraînons notre modèle sur le jeu de données d'entraînement.

```python
model.fit(X_train, Y_train, epochs=10, validation_data=(X_test, Y_test))
```

### 7. Évaluer le modèle
Après l'entraînement, évaluons les performances de notre modèle.

```python
loss, accuracy = model.evaluate(X_test, Y_test)
print(f'Précision : {accuracy}')
```

### 8. Prédictions
Enfin, utilisons notre modèle pour prédire le sentiment de nouvelles critiques.

```python
new_reviews = ['Cette film était incroyable!', 'Je n'aime pas ce film.']
new_sequences = tokenizer.texts_to_sequences(new_reviews)
new_X = pad_sequences(new_sequences, maxlen=max_length)
predictions = model.predict(new_X)
predicted_classes = np.argmax(predictions, axis=1)
for review, sentiment in zip(new_reviews, predicted_classes):
    print(f'Revue : {review} | Sentiment : {label_encoder.inverse_transform([sentiment])[0]}')
```

## Conclusion
Dans ce travail pratique, vous avez utilisé TensorFlow ou PyTorch pour construire un modèle de détection de sentiment. Vous avez appris à prétraiter des données textuelles, à créer et à entraîner un réseau neuronal, et enfin, à faire des prédictions sur de nouvelles critiques.