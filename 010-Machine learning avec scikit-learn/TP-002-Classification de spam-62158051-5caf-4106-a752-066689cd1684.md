# Travail Pratique : Classification de Spam avec Scikit-Learn

## Objectif
L'objectif de ce travail pratique est de découvrir l'entraînement de modèles prédictifs à travers la classification de messages électroniques comme étant des spams ou non.

## Prérequis
- Python 3.x
- Bibliothèques : pandas, numpy, scikit-learn, matplotlib

## Étapes du Travail Pratique

### 1. Installation des bibliothèques nécessaires
Avant de commencer, assurez-vous d'avoir installé les bibliothèques nécessaires.

```bash
pip install pandas numpy scikit-learn matplotlib
```

### 2. Chargement des données
Nous allons utiliser un jeu de données de messages étiquetés comme spam ou non spam. Vous pouvez télécharger le fichier `spam.csv` à partir de [ce lien](https://archive.ics.uci.edu/ml/datasets/sms+spam+collection).

```python
import pandas as pd

data = pd.read_csv('spam.csv', encoding='latin-1')

# Vérifiez la structure des données
print(data.head())
```

### 3. Prétraitement des données
La première étape du prétraitement consiste à nettoyer les données et à les transformer pour qu'elles puissent être utilisées par notre modèle.

```python
# Renommer les colonnes
data = data.rename(columns={'v1': 'label', 'v2': 'message'})

data['label'] = data['label'].map({'ham': 0, 'spam': 1})

# Tokenisation et vectorisation
from sklearn.feature_extraction.text import CountVectorizer

vectorizer = CountVectorizer()
X = vectorizer.fit_transform(data['message']).toarray()
Y = data['label']
```

### 4. Diviser les données en ensembles d'entraînement et de test
Nous allons diviser notre jeu de données en un ensemble d'entraînement et un ensemble de test.

```python
from sklearn.model_selection import train_test_split

X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=42)
```

### 5. Entraîner le modèle
Nous allons maintenant entraîner un modèle de classification en utilisant le classificateur Naive Bayes.

```python
from sklearn.naive_bayes import MultinomialNB

model = MultinomialNB()
model.fit(X_train, Y_train)
```

### 6. Prédiction et évaluation du modèle
Après l'entraînement, vous pouvez évaluer la performance de votre modèle sur l'ensemble de test.

```python
from sklearn.metrics import accuracy_score, classification_report

Y_pred = model.predict(X_test)

# Évaluer le modèle
print('Accuracy:', accuracy_score(Y_test, Y_pred))
print(classification_report(Y_test, Y_pred))
```

### 7. Visualiser les résultats
Pour visualiser les résultats, vous pouvez créer une matrice de confusion.

```python
import matplotlib.pyplot as plt
from sklearn.metrics import ConfusionMatrixDisplay

ConfusionMatrixDisplay.from_estimator(model, X_test, Y_test)
plt.show()
```

## Corrigé
1. Chargez les données à l'aide de pandas.
2. Préprocessez les données pour créer des vecteurs.
3. Divisez les données en ensembles d'entraînement (80%) et de test (20%).
4. Entraînez le modèle avec les données d'entraînement.
5. Évaluez le modèle sur l'ensemble de test et notez l'accuracy et le rapport de classification.
6. Visualisez la matrice de confusion.

## Conclusion
Dans ce travail pratique, vous avez appris à charger des données, les prétraiter, entraîner un modèle de machine learning et évaluer sa performance. Vous pouvez maintenant explorer d'autres classificateurs et techniques de prétraitement pour améliorer la précision de votre modèle.